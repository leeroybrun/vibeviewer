# Project Overview

See Tuist/modularization details: `.cursor/rules/tuist.mdc`
See architecture/design rules: `.cursor/rules/architecture.mdc`

AIUsageTracker is a macOS 14+ menu-bar application built with Swift 5.10 and SwiftUI. The workspace is Tuist-driven and organized into multiple Swift Packages so that UI, networking, storage, and automation concerns stay isolated and testable.

- **Frameworks & Tech**: SwiftUI, Swift Concurrency (async/await, actors, @MainActor), Swift Package Manager, Tuist.
- **Architecture**: SwiftUI Model-View with `@Environment` dependency injection. No global MVVM layer.
- **Testing**: Each package includes a `Tests/` target (some rely on macOS-only frameworks and must be executed on macOS).
- **Platform**: macOS (menu-bar app). Keychain is used for credential storage.

## Workspace layout
```
AIUsageTracker/
├── AIUsageTracker/               # Thin app wrapper (@main entry + assets)
├── Packages/
│   ├── AIUsageTrackerCore/
│   ├── AIUsageTrackerModel/
│   ├── AIUsageTrackerAPI/
│   ├── AIUsageTrackerAppEnvironment/
│   ├── AIUsageTrackerStorage/
│   ├── AIUsageTrackerLoginUI/
│   ├── AIUsageTrackerMenuUI/
│   ├── AIUsageTrackerSettingsUI/
│   └── AIUsageTrackerShareUI/
├── docs/
├── Scripts/
└── Makefile
```

## Coding guidelines
- Prefer value types (`struct`, `enum`) and mark them `Sendable` when needed.
- Inject shared services through `@Environment` keys exposed by their packages.
- Keep UI state local with `@State`/`@Binding`; place side effects inside `.task` or `.onChange`.
- Avoid force unwraps; surface meaningful errors.
- Break complex views into smaller components; keep the menu popover lightweight.

## Tooling
- Generate workspace: `make generate`
- Clear caches: `make clear`
- Release pipeline: `make release`

## Platform notes
- Credential storage uses the macOS Keychain; Linux CI cannot exercise those code paths.
- Some background services depend on ServiceManagement and NotificationCenter APIs that exist only on macOS—wrap new functionality with availability checks.
